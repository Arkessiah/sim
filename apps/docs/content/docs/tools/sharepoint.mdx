---
title: Sharepoint
description: Read and create pages
---

import { BlockInfoCard } from "@/components/ui/block-info-card"
import { Accordion, Accordions } from "fumadocs-ui/components/accordion"


<BlockInfoCard 
  type="sharepoint"
  color="#E0E0E0"
  icon={true}
  iconSvg={`<svg className="block-icon"  fill='currentColor' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg'>
      <circle fill='#036C70' cx='16.31' cy='8.90' r='8.90' />
      <circle fill='#1A9BA1' cx='23.72' cy='17.05' r='8.15' />
      <circle fill='#37C6D0' cx='17.42' cy='24.83' r='6.30' />
      <path
        fill='#000000'
        opacity='0.1'
        d='M17.79,8.03v15.82c0,0.55-0.34,1.04-0.85,1.25c-0.16,0.07-0.34,0.10-0.51,0.10H11.13c-0.01-0.13-0.01-0.24-0.01-0.37c0-0.12,0-0.25,0.01-0.37c0.14-2.37,1.59-4.46,3.77-5.40v-1.38c-4.85-0.77-8.15-5.32-7.39-10.17c0.01-0.03,0.01-0.07,0.02-0.10c0.04-0.25,0.09-0.50,0.16-0.74h8.74c0.74,0,1.36,0.60,1.36,1.36z'
      />
      <path
        fill='#000000'
        opacity='0.2'
        d='M15.69,7.41H7.54c-0.82,4.84,2.43,9.43,7.27,10.25c0.15,0.02,0.29,0.05,0.44,0.06c-2.30,1.09-3.97,4.18-4.12,6.73c-0.01,0.12-0.02,0.25-0.01,0.37c0,0.13,0,0.24,0.01,0.37c0.01,0.25,0.05,0.50,0.10,0.74h4.47c0.55,0,1.04-0.34,1.25-0.85c0.07-0.16,0.10-0.34,0.10-0.51V8.77c0-0.75-0.61-1.36-1.36-1.36z'
      />
      <path
        fill='#000000'
        opacity='0.2'
        d='M15.69,7.41H7.54c-0.82,4.84,2.43,9.43,7.27,10.26c0.10,0.02,0.20,0.03,0.30,0.05c-2.22,1.17-3.83,4.26-3.97,6.75h4.56c0.75,0,1.35-0.61,1.36-1.36V8.77c0-0.75-0.61-1.36-1.36-1.36z'
      />
      <path
        fill='#000000'
        opacity='0.2'
        d='M14.95,7.41H7.54c-0.78,4.57,2.08,8.97,6.58,10.11c-1.84,2.43-2.27,5.61-2.58,7.22h3.82c0.75,0,1.35-0.61,1.36-1.36V8.77c0-0.75-0.61-1.36-1.36-1.36z'
      />
      <path
        fill='#008789'
        d='M1.36,7.41h13.58c0.75,0,1.36,0.61,1.36,1.36v13.58c0,0.75-0.61,1.36-1.36,1.36H1.36c-0.75,0-1.36-0.61-1.36-1.36V8.77C0,8.02,0.61,7.41,1.36,7.41z'
      />
      <path
        fill='#FFFFFF'
        d='M6.07,15.42c-0.32-0.21-0.58-0.49-0.78-0.82c-0.19-0.34-0.28-0.73-0.27-1.12c-0.02-0.53,0.16-1.05,0.50-1.46c0.36-0.41,0.82-0.71,1.34-0.87c0.59-0.19,1.21-0.29,1.83-0.28c0.82-0.03,1.63,0.08,2.41,0.34v1.71c-0.34-0.20-0.71-0.35-1.09-0.44c-0.42-0.10-0.84-0.15-1.27-0.15c-0.45-0.02-0.90,0.08-1.31,0.28c-0.31,0.14-0.52,0.44-0.52,0.79c0,0.21,0.08,0.41,0.22,0.56c0.17,0.18,0.37,0.32,0.59,0.42c0.25,0.12,0.62,0.29,1.11,0.49c0.05,0.02,0.11,0.04,0.16,0.06c0.49,0.19,0.96,0.42,1.40,0.69c0.34,0.21,0.62,0.49,0.83,0.83c0.21,0.39,0.31,0.82,0.30,1.26c0.02,0.54-0.14,1.08-0.47,1.52c-0.33,0.40-0.77,0.69-1.26,0.85c-0.58,0.18-1.19,0.27-1.80,0.26c-0.55,0-1.09-0.04-1.63-0.13c-0.45-0.07-0.90-0.20-1.32-0.39v-1.80c0.40,0.29,0.86,0.50,1.34,0.64c0.48,0.15,0.97,0.23,1.47,0.24c0.46,0.03,0.92-0.07,1.34-0.28c0.29-0.16,0.46-0.47,0.46-0.80c0-0.23-0.09-0.45-0.25-0.61c-0.20-0.20-0.44-0.36-0.69-0.48c-0.30-0.15-0.73-0.34-1.31-0.59C6.91,16.14,6.48,15.80,6.07,15.42z'
      />
    </svg>`}
/>

{/* MANUAL-CONTENT-START:intro */}
[SharePoint](https://www.microsoft.com/en-us/microsoft-365/sharepoint/collaboration) is a collaborative platform from Microsoft that enables users to build and manage internal websites, share documents, and organize team resources. It provides a powerful, flexible solution for creating digital workspaces and streamlining content management across organizations.

With SharePoint, you can:

- **Create team and communication sites**: Set up pages and portals to support collaboration, announcements, and content distribution
- **Organize and share content**: Store documents, manage files, and enable version control with secure sharing capabilities
- **Customize pages**: Add text parts to tailor each site to your team's needs
- **Improve discoverability**: Use metadata, search, and navigation tools to help users quickly find what they need
- **Collaborate securely**: Control access with robust permission settings and Microsoft 365 integration

In Sim, the SharePoint integration empowers your agents to create and access SharePoint sites and pages as part of their workflows. This enables automated document management, knowledge sharing, and workspace creation without manual effort. Agents can generate new project pages, upload or retrieve files, and organize resources dynamically, based on workflow inputs. By connecting Sim with SharePoint, you bring structured collaboration and content management into your automation flows — giving your agents the ability to coordinate team activities, surface key information, and maintain a single source of truth across your organization.
{/* MANUAL-CONTENT-END */}


## Operations

### `sharepoint_create_page`

Create a new page in a SharePoint site

#### Input

| Parameter | Type | Required | Description |
| --------- | ---- | -------- | ----------- |
| `siteId` | string | No | The ID of the SharePoint site \(internal use\) |
| `siteSelector` | string | No | Select the SharePoint site |
| `pageName` | string | Yes | The name of the page to create |
| `pageTitle` | string | No | The title of the page \(defaults to page name if not provided\) |
| `pageContent` | string | No | The content of the page |

#### Output

| Parameter | Type | Description |
| --------- | ---- | ----------- |
| `page` | object | Created SharePoint page information |

### `sharepoint_read_page`

Read a specific page from a SharePoint site

#### Input

| Parameter | Type | Required | Description |
| --------- | ---- | -------- | ----------- |
| `siteSelector` | string | No | Select the SharePoint site |
| `siteId` | string | No | The ID of the SharePoint site \(internal use\) |
| `pageId` | string | No | The ID of the page to read |
| `pageName` | string | No | The name of the page to read \(alternative to pageId\) |
| `maxPages` | number | No | Maximum number of pages to return when listing all pages \(default: 10, max: 50\) |

#### Output

| Parameter | Type | Description |
| --------- | ---- | ----------- |
| `page` | object | Information about the SharePoint page |

### `sharepoint_list_sites`

List details of all SharePoint sites

#### Input

| Parameter | Type | Required | Description |
| --------- | ---- | -------- | ----------- |
| `siteSelector` | string | No | Select the SharePoint site |
| `groupId` | string | No | The group ID for accessing a group team site |

#### Output

| Parameter | Type | Description |
| --------- | ---- | ----------- |
| `site` | object | Information about the current SharePoint site |



## Best Practices

{/* MANUAL-CONTENT-START:bestPractices */}
The SharePoint block serves as a critical content management connector in Sim.ai workflows, enabling seamless integration between automated processes and Microsoft SharePoint's collaborative platform. This block empowers workflows to read existing SharePoint content, create new pages dynamically, and manage site-level operations with proper OAuth authentication, making it essential for document automation and content publishing workflows.

**Connection Tag Usage and Data Flow**

Effective SharePoint integration relies on strategic connection tag implementation across multiple data flow patterns. The `<sharepoint1.page>` output contains comprehensive page information that can be mapped to downstream blocks for content analysis or transformation. When creating pages, route dynamic content through `<agent1.content>` to the `pageContent` input, enabling AI-generated content to be published directly to SharePoint sites.

Site management workflows benefit from the `<sharepoint1.sites>` array output, which provides structured site data including IDs, names, and metadata. Map this data to subsequent SharePoint operations using `<sharepoint1.sites[0].id>` for the `siteId` parameter, creating efficient site-to-site content workflows. For page identification, use either `<sharepoint1.page.id>` for the `pageId` input or maintain page names through `<sharepoint1.page.name>` for name-based lookups.

Advanced data flow patterns leverage the optional parameters strategically. The `maxPages` parameter accepts numeric values up to 50, allowing controlled pagination when processing large site collections. Connection tags like `<function1.calculatedLimit>` can dynamically set this parameter based on workflow requirements.

**Workflow Architecture Patterns**

SharePoint workflows typically follow established architectural patterns optimized for content lifecycle management. The **Agent → SharePoint Create → Notification** pattern enables AI-driven content generation where intelligent agents produce formatted content that gets published to SharePoint pages automatically. This pattern works exceptionally well for documentation generation and knowledge base updates.

For content synchronization workflows, implement **Webhook → SharePoint Read → Database → SharePoint Create** patterns. This architecture enables cross-site content replication with transformation capabilities, where content changes in one location trigger automated updates across multiple SharePoint sites.

Monitoring and audit workflows benefit from **Schedule → SharePoint List Sites → Function → Database** patterns, where periodic site enumeration feeds into analysis functions for governance and compliance reporting. The sites array output provides rich metadata for tracking site usage and permissions.

Content enrichment workflows use **SharePoint Read → Agent → SharePoint Create** patterns, where existing content gets processed by AI agents and enhanced versions are published as new pages. This pattern enables automated content updates and version management.

**Message/Data Formatting Excellence**

SharePoint content formatting requires attention to both structure and metadata for optimal presentation. The `pageContent` parameter accepts rich HTML formatting, enabling complex document layouts with embedded media and structured data. Format AI-generated content with proper HTML tags including `<h1>`, `<p>`, `<ul>`, and `<table>` elements for professional presentation.

Page naming conventions significantly impact discoverability and organization. Use descriptive `pageName` values that follow consistent patterns like "Report_YYYY-MM-DD" or "Process_Documentation_v1". The optional `pageTitle` parameter should provide human-readable titles that differ from the technical page names when necessary.

When working with site selectors, maintain consistency in `siteSelector` values across workflow executions. Store site identifiers in workflow variables or configuration blocks to ensure reliable site targeting. The `groupId` parameter enables access to team sites with specific group associations, requiring proper Azure AD group identifiers.

Content validation becomes critical for page creation operations. Implement input sanitization for `pageContent` to prevent formatting issues and ensure SharePoint compatibility. Use connection tags like `<function1.sanitizedContent>` to clean and validate content before page creation.

**Debugging and Monitoring**

SharePoint block monitoring requires comprehensive tracking of authentication status, operation success rates, and content delivery metrics. Monitor the `<sharepoint1.page>` output structure to verify successful page creation and retrieval operations. Missing or malformed page objects indicate authentication issues or insufficient permissions.

Authentication debugging focuses on OAuth token validity and scope permissions. SharePoint operations require specific permission scopes for site access and page management. Failed operations often result from expired tokens or insufficient application permissions in the Microsoft 365 admin center.

Site identification errors commonly occur with incorrect `siteId` or `siteSelector` values. Implement validation workflows using the list sites operation to verify site accessibility before attempting page operations. The sites output array helps troubleshoot site discovery issues and permission boundaries.

Page operation failures frequently stem from naming conflicts or content formatting issues. Monitor `pageName` uniqueness within sites and validate HTML content structure before creation operations. Implement retry logic for transient connection failures, particularly during high-traffic periods.

Performance monitoring should track operation completion times and success rates across different sites and content sizes. Large `pageContent` payloads may experience longer processing times, requiring timeout adjustments in workflow configurations.

**Security Considerations**

SharePoint security implementation requires careful attention to authentication scope and data handling practices. OAuth authentication provides secure, token-based access without storing credentials in workflows. Ensure application registrations in Azure AD include only necessary permissions for SharePoint site access and page management.

Content security involves validating and sanitizing all user-generated content before page creation. Implement input validation for `pageContent` to prevent script injection and malformed HTML that could compromise SharePoint site security. Use allow-lists for HTML tags and attributes rather than block-lists for comprehensive protection.

Site access control requires proper understanding of SharePoint permissions models. The `groupId` parameter should only reference groups with appropriate access levels. Implement role-based access patterns where workflow execution contexts match required permission levels for target sites.

Data residency considerations apply when processing sensitive content through SharePoint operations. Ensure compliance with organizational policies regarding data storage locations and access logging requirements.

**Performance Optimization**

SharePoint performance optimization focuses on efficient site targeting, content sizing, and operation batching strategies. Use specific `siteId` values when available rather than relying on `siteSelector` searches, reducing lookup overhead and improving operation response times.

Content optimization involves managing `pageContent` size and complexity. Large HTML payloads increase processing time and may encounter SharePoint limits. Implement content chunking strategies for extensive documents, creating multiple pages with cross-references rather than single large pages.

Batch operations improve efficiency when working with multiple pages or sites. Instead of individual page creation operations, accumulate content and create pages in logical groups. Use the `maxPages` parameter strategically to control data retrieval volume and prevent timeout issues.

Caching strategies enhance repeated operations on the same sites or pages. Store site information from list operations in workflow variables to avoid repeated site discovery calls. Implement conditional logic to check page existence before creation attempts, reducing unnecessary API calls.

Connection pooling and rate limiting considerations apply to high-volume SharePoint operations. Implement delays between operations when processing large page collections to respect SharePoint API throttling limits and maintain consistent performance across workflow executions.
{/* MANUAL-CONTENT-END */}


## FAQ

{/* MANUAL-CONTENT-START:faq */}
<Accordions type="single">
  <Accordion title="How do I create a new SharePoint page from my workflow?">

    To create a SharePoint page from your Sim.ai workflow, add a **SharePoint block** and configure the `sharepoint_create_page` operation:

    #### Required Inputs

    | Input | Description | Example |
    |-------|-------------|---------|
    | `pageName` | The name for your new page | `<start.pageName>` or `"My New Page"` |
    | `siteSelector` | Choose your target SharePoint site | Select from dropdown or use `<start.siteSelector>` |
    | `pageTitle` | Display title (optional) | `<agent1.title>` or defaults to `pageName` |
    | `pageContent` | HTML or text content | `<agent1.content>` for AI-generated content |

    The block outputs `<sharepoint1.page>` containing the created page information including ID, URL, and metadata.
  </Accordion>
  <Accordion title="How do I read existing SharePoint page content in my workflow?">

    To retrieve SharePoint page content, configure the SharePoint block with the `sharepoint_read_page` operation:

    #### Input Options

    | Method | Input Field | Example |
    |--------|-------------|---------|
    | **By Page ID** | `pageId` | `<start.pageId>` or static ID |
    | **By Page Name** | `pageName` | `<start.pageName>` or `"Sales Report"` |
    | **List All Pages** | `maxPages` | `10` (default) to `50` (maximum) |

    Use `<sharepoint1.page>` to access the retrieved page data in downstream blocks like Agent or Function blocks for content processing.
  </Accordion>
  <Accordion title="What is the correct way to reference SharePoint block outputs in my workflow?">

    SharePoint blocks expose different outputs depending on the operation used:

    #### Available Output Tags

    | Output Tag | Operation | Type | Description |
    |------------|-----------|------|-------------|
    | `<sharepoint1.page>` | create_page, read_page | Object | Page information with ID, title, content, URL |
    | `<sharepoint1.site>` | list_sites | Object | Current site details with ID, name, web URL |
    | `<sharepoint1.sites>` | list_sites | Array | All available SharePoint sites |

    Connect these outputs to other blocks using the connection menu or by typing the tag directly into input fields.
  </Accordion>
  <Accordion title="How do I connect an Agent block to generate SharePoint page content automatically?">

    To use AI-generated content for SharePoint pages:

    1. **Agent Block First**: Configure an Agent to generate content based on your prompt
    2. **Connect to SharePoint**: In the SharePoint block's inputs:
       - Set `pageContent` to `<agent1.content>`
       - Set `pageTitle` to `<agent1.title>` if the agent generates titles
       - Set `pageName` to either `<start.pageName>` or a static value

    #### Example Workflow Pattern
    ```
    Webhook → Agent → SharePoint (create_page)
    ```

    This pattern processes incoming data with AI and automatically creates SharePoint pages with the generated content.
  </Accordion>
  <Accordion title="Why is my SharePoint block failing with authentication errors?">

    SharePoint blocks require OAuth authentication setup in Sim.ai:

    #### Common Authentication Issues

    | Issue | Description | Solution |
    |-------|-------------|----------|
    | **No Site Access** | Block cannot access SharePoint sites | Ensure OAuth app has Sites.ReadWrite.All permissions |
    | **Invalid Site Selector** | Selected site doesn't exist | Use `list_sites` operation first to verify available sites |
    | **Missing Tenant** | SharePoint tenant not configured | Contact admin to configure tenant in OAuth settings |
    | **Expired Token** | Authentication token expired | Re-authenticate through block settings |

    Verify your site selection using `<sharepoint1.sites>` from the `list_sites` operation before creating or reading pages.
  </Accordion>
  <Accordion title="Can I use SharePoint blocks with conditional logic and other workflow components?">

    Yes! SharePoint blocks integrate seamlessly with other Sim.ai components:

    #### Advanced Workflow Patterns

    ##### 1. **Content Processing Pipeline**
    ```
    Webhook → Function → Agent → SharePoint (create_page)
    ```
    Process incoming data, generate AI content, and create SharePoint pages automatically.

    ##### 2. **Conditional Page Creation**
    ```
    API → Condition → SharePoint (create_page)
                    → Email (alternative action)
    ```
    Create pages only when specific conditions are met, otherwise send notifications.

    ##### 3. **Page Content Analysis**
    ```
    SharePoint (read_page) → Agent → SharePoint (create_page)
    ```
    Read existing pages, analyze with AI, and create summary or follow-up pages.

    ##### 4. **Multi-Site Management**
    Use `<sharepoint1.sites>` with Function blocks to iterate over multiple sites and perform bulk operations across your SharePoint environment.
  </Accordion>
  <Accordion title="How do I handle SharePoint page creation errors in my workflow?">

    Implement error handling for common SharePoint operation failures:

    #### Common Error Scenarios

    | Error Type | Cause | Prevention |
    |------------|-------|------------|
    | **Page Already Exists** | Duplicate `pageName` in site | Use dynamic names like `<function1.uniqueName>` |
    | **Invalid Characters** | Special characters in page name | Sanitize input with Function block before SharePoint |
    | **Content Too Large** | Page content exceeds limits | Truncate `<agent1.content>` using Function block |
    | **Site Access Denied** | Insufficient permissions | Verify `siteSelector` matches accessible sites from `<sharepoint1.sites>` |

    Add Condition blocks after SharePoint operations to check success status and implement fallback actions for failed page operations.
  </Accordion>
</Accordions>
{/* MANUAL-CONTENT-END */}
